<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>My dissertation</title>
  <meta name="description" content="My dissertation">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="My dissertation" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="tjmahr/dissertation" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="My dissertation" />
  
  
  

<meta name="author" content="Tristan Mahr">


<meta name="date" content="2017-11-15">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="prepare-and-explore-the-data.html">
<link rel="next" href="visualize-looks-to-each-image-type.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="assets\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">My dissertation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Development of word recognition in preschoolers</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#updates"><i class="fa fa-check"></i>Updates</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="scratch-paper.html"><a href="scratch-paper.html"><i class="fa fa-check"></i><b>1</b> Scratch paper</a><ul>
<li class="chapter" data-level="1.1" data-path="scratch-paper.html"><a href="scratch-paper.html#bookdown-cheatsheet"><i class="fa fa-check"></i><b>1.1</b> Bookdown cheatsheet</a><ul>
<li class="chapter" data-level="1.1.1" data-path="scratch-paper.html"><a href="scratch-paper.html#manual-section-label-demo"><i class="fa fa-check"></i><b>1.1.1</b> Cross-references to sections</a></li>
<li class="chapter" data-level="1.1.2" data-path="scratch-paper.html"><a href="scratch-paper.html#cross-references-to-appendices"><i class="fa fa-check"></i><b>1.1.2</b> Cross-references to appendices</a></li>
<li class="chapter" data-level="1.1.3" data-path="scratch-paper.html"><a href="scratch-paper.html#cross-references-to-tables"><i class="fa fa-check"></i><b>1.1.3</b> Cross-references to tables</a></li>
<li class="chapter" data-level="1.1.4" data-path="scratch-paper.html"><a href="scratch-paper.html#figure-references-and-using-text-references-as-captions"><i class="fa fa-check"></i><b>1.1.4</b> Figure references and using text references as captions</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="scratch-paper.html"><a href="scratch-paper.html#debug-info"><i class="fa fa-check"></i><b>1.2</b> Debug info</a></li>
</ul></li>
<li class="part"><span><b>Prospectus</b></span></li>
<li class="chapter" data-level="2" data-path="front-matter.html"><a href="front-matter.html"><i class="fa fa-check"></i><b>2</b> Front Matter</a><ul>
<li class="chapter" data-level="" data-path="front-matter.html"><a href="front-matter.html#about-this-document"><i class="fa fa-check"></i>About This Document</a></li>
<li class="chapter" data-level="" data-path="front-matter.html"><a href="front-matter.html#dissertation-committee-members"><i class="fa fa-check"></i>Dissertation Committee Members</a></li>
<li class="chapter" data-level="" data-path="front-matter.html"><a href="front-matter.html#planned-dissertation-format"><i class="fa fa-check"></i>Planned Dissertation Format</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="specific-aims.html"><a href="specific-aims.html"><i class="fa fa-check"></i><b>3</b> Specific Aims</a><ul>
<li class="chapter" data-level="3.1" data-path="specific-aims.html"><a href="specific-aims.html#specific-aim-1-familiar-word-recognition-and-lexical-competition"><i class="fa fa-check"></i><b>3.1</b> Specific Aim 1 (Familiar Word Recognition and Lexical Competition)</a></li>
<li class="chapter" data-level="3.2" data-path="specific-aims.html"><a href="specific-aims.html#specific-aim-2-referent-selection-and-mispronunciations"><i class="fa fa-check"></i><b>3.2</b> Specific Aim 2 (Referent Selection and Mispronunciations)</a></li>
<li class="chapter" data-level="3.3" data-path="specific-aims.html"><a href="specific-aims.html#specific-aim-3-computational-modeling"><i class="fa fa-check"></i><b>3.3</b> Specific Aim 3 (Computational Modeling)</a></li>
<li class="chapter" data-level="3.4" data-path="specific-aims.html"><a href="specific-aims.html#summary"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="significance.html"><a href="significance.html"><i class="fa fa-check"></i><b>4</b> Significance</a><ul>
<li class="chapter" data-level="4.1" data-path="significance.html"><a href="significance.html#public-health-significance"><i class="fa fa-check"></i><b>4.1</b> Public Health Significance</a></li>
<li class="chapter" data-level="4.2" data-path="significance.html"><a href="significance.html#scientific-significance"><i class="fa fa-check"></i><b>4.2</b> Scientific Significance</a><ul>
<li class="chapter" data-level="4.2.1" data-path="significance.html"><a href="significance.html#lexical-processing-dynamics"><i class="fa fa-check"></i><b>4.2.1</b> Lexical Processing Dynamics</a></li>
<li class="chapter" data-level="4.2.2" data-path="significance.html"><a href="significance.html#individual-differences-in-word-recognition"><i class="fa fa-check"></i><b>4.2.2</b> Individual Differences in Word Recognition</a></li>
<li class="chapter" data-level="4.2.3" data-path="significance.html"><a href="significance.html#computational-modeling"><i class="fa fa-check"></i><b>4.2.3</b> Computational Modeling</a></li>
<li class="chapter" data-level="4.2.4" data-path="significance.html"><a href="significance.html#summary-1"><i class="fa fa-check"></i><b>4.2.4</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="research-hypotheses.html"><a href="research-hypotheses.html"><i class="fa fa-check"></i><b>5</b> Research Hypotheses</a><ul>
<li class="chapter" data-level="5.1" data-path="research-hypotheses.html"><a href="research-hypotheses.html#specific-aim-1-familiar-word-recognition-and-lexical-competition-1"><i class="fa fa-check"></i><b>5.1</b> Specific Aim 1 (Familiar Word Recognition and Lexical Competition)</a></li>
<li class="chapter" data-level="5.2" data-path="research-hypotheses.html"><a href="research-hypotheses.html#specific-aim-2-referent-selection-and-mispronunciations-1"><i class="fa fa-check"></i><b>5.2</b> Specific Aim 2 (Referent Selection and Mispronunciations)</a></li>
<li class="chapter" data-level="5.3" data-path="research-hypotheses.html"><a href="research-hypotheses.html#specific-aim-3-computational-modeling-1"><i class="fa fa-check"></i><b>5.3</b> Specific Aim 3 (Computational Modeling)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>6</b> Methods</a><ul>
<li class="chapter" data-level="6.1" data-path="methods.html"><a href="methods.html#general-research-design-participants"><i class="fa fa-check"></i><b>6.1</b> General Research Design: Participants</a></li>
<li class="chapter" data-level="6.2" data-path="methods.html"><a href="methods.html#general-eyetracking-procedure"><i class="fa fa-check"></i><b>6.2</b> General Eyetracking Procedure</a><ul>
<li class="chapter" data-level="6.2.1" data-path="methods.html"><a href="methods.html#experiment-administration"><i class="fa fa-check"></i><b>6.2.1</b> Experiment Administration</a></li>
<li class="chapter" data-level="6.2.2" data-path="methods.html"><a href="methods.html#stimuli"><i class="fa fa-check"></i><b>6.2.2</b> Stimuli</a></li>
<li class="chapter" data-level="6.2.3" data-path="methods.html"><a href="methods.html#data-preparation"><i class="fa fa-check"></i><b>6.2.3</b> Data Preparation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="methods.html"><a href="methods.html#specific-procedure-aim-1-familiar-word-recognition-and-lexical-competition"><i class="fa fa-check"></i><b>6.3</b> Specific Procedure: Aim 1 (Familiar Word Recognition and Lexical Competition)</a></li>
<li class="chapter" data-level="6.4" data-path="methods.html"><a href="methods.html#specific-procedure-aim-2-referent-selection-and-mispronunciations"><i class="fa fa-check"></i><b>6.4</b> Specific Procedure: Aim 2 (Referent Selection and Mispronunciations)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="outcome-measures.html"><a href="outcome-measures.html"><i class="fa fa-check"></i><b>7</b> Outcome Measures</a><ul>
<li class="chapter" data-level="7.1" data-path="outcome-measures.html"><a href="outcome-measures.html#sample-data"><i class="fa fa-check"></i><b>7.1</b> Sample Data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>8</b> Analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="analysis.html"><a href="analysis.html#growth-curve-analysis"><i class="fa fa-check"></i><b>8.1</b> Growth Curve Analysis</a></li>
<li class="chapter" data-level="8.2" data-path="analysis.html"><a href="analysis.html#aim-1-familiar-word-recognition-and-lexical-competition"><i class="fa fa-check"></i><b>8.2</b> Aim 1 (Familiar Word Recognition and Lexical Competition)</a></li>
<li class="chapter" data-level="8.3" data-path="analysis.html"><a href="analysis.html#aim-2-referent-selection-and-mispronunciations"><i class="fa fa-check"></i><b>8.3</b> Aim 2 (Referent Selection and Mispronunciations)</a></li>
<li class="chapter" data-level="8.4" data-path="analysis.html"><a href="analysis.html#aim-3-computational-modeling"><i class="fa fa-check"></i><b>8.4</b> Aim 3 (Computational Modeling)</a><ul>
<li class="chapter" data-level="8.4.1" data-path="analysis.html"><a href="analysis.html#trace-model-architecture"><i class="fa fa-check"></i><b>8.4.1</b> TRACE Model Architecture</a></li>
<li class="chapter" data-level="8.4.2" data-path="analysis.html"><a href="analysis.html#modeling-looking-data"><i class="fa fa-check"></i><b>8.4.2</b> Modeling Looking Data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Aim 1: Familiar Word Recognition and Lexical Competition</b></span></li>
<li class="chapter" data-level="9" data-path="prepare-and-explore-the-data.html"><a href="prepare-and-explore-the-data.html"><i class="fa fa-check"></i><b>9</b> Prepare and explore the data</a><ul>
<li class="chapter" data-level="9.1" data-path="prepare-and-explore-the-data.html"><a href="prepare-and-explore-the-data.html#raw-data-visualization"><i class="fa fa-check"></i><b>9.1</b> Raw data visualization</a></li>
<li class="chapter" data-level="9.2" data-path="prepare-and-explore-the-data.html"><a href="prepare-and-explore-the-data.html#data-screening"><i class="fa fa-check"></i><b>9.2</b> Data screening</a><ul>
<li class="chapter" data-level="9.2.1" data-path="prepare-and-explore-the-data.html"><a href="prepare-and-explore-the-data.html#add-a-note-about-the-bad-version-of-the-experiment"><i class="fa fa-check"></i><b>9.2.1</b> Add a note about the bad version of the experiment</a></li>
<li class="chapter" data-level="9.2.2" data-path="prepare-and-explore-the-data.html"><a href="prepare-and-explore-the-data.html#special-case-data-screening"><i class="fa fa-check"></i><b>9.2.2</b> Special case data screening</a></li>
<li class="chapter" data-level="9.2.3" data-path="prepare-and-explore-the-data.html"><a href="prepare-and-explore-the-data.html#interim-summary"><i class="fa fa-check"></i><b>9.2.3</b> Interim summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="analyze-familiar-word-recognition.html"><a href="analyze-familiar-word-recognition.html"><i class="fa fa-check"></i><b>10</b> Analyze familiar word recognition</a><ul>
<li class="chapter" data-level="10.1" data-path="analyze-familiar-word-recognition.html"><a href="analyze-familiar-word-recognition.html#data-preparation-1"><i class="fa fa-check"></i><b>10.1</b> Data preparation</a></li>
<li class="chapter" data-level="10.2" data-path="analyze-familiar-word-recognition.html"><a href="analyze-familiar-word-recognition.html#maximum-likelihood-results"><i class="fa fa-check"></i><b>10.2</b> Maximum likelihood results</a><ul>
<li class="chapter" data-level="10.2.1" data-path="analyze-familiar-word-recognition.html"><a href="analyze-familiar-word-recognition.html#whats-being-captured-by-the-random-effects"><i class="fa fa-check"></i><b>10.2.1</b> What’s being captured by the random effects?</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="analyze-familiar-word-recognition.html"><a href="analyze-familiar-word-recognition.html#bayesian-model-results"><i class="fa fa-check"></i><b>10.3</b> Bayesian model results</a><ul>
<li class="chapter" data-level="10.3.1" data-path="analyze-familiar-word-recognition.html"><a href="analyze-familiar-word-recognition.html#fixed-effects-plots"><i class="fa fa-check"></i><b>10.3.1</b> Fixed effects plots</a></li>
<li class="chapter" data-level="10.3.2" data-path="analyze-familiar-word-recognition.html"><a href="analyze-familiar-word-recognition.html#plot-the-intervals-for-the-random-effect-parameters"><i class="fa fa-check"></i><b>10.3.2</b> Plot the intervals for the random effect parameters</a></li>
<li class="chapter" data-level="10.3.3" data-path="analyze-familiar-word-recognition.html"><a href="analyze-familiar-word-recognition.html#check-for-stable-individual-differences"><i class="fa fa-check"></i><b>10.3.3</b> Check for stable individual differences</a></li>
<li class="chapter" data-level="10.3.4" data-path="analyze-familiar-word-recognition.html"><a href="analyze-familiar-word-recognition.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>10.3.4</b> Posterior predictive checks</a></li>
<li class="chapter" data-level="10.3.5" data-path="analyze-familiar-word-recognition.html"><a href="analyze-familiar-word-recognition.html#look-at-some-predictions"><i class="fa fa-check"></i><b>10.3.5</b> Look at some predictions</a></li>
<li class="chapter" data-level="10.3.6" data-path="analyze-familiar-word-recognition.html"><a href="analyze-familiar-word-recognition.html#predicting-the-future"><i class="fa fa-check"></i><b>10.3.6</b> Predicting the future</a></li>
<li class="chapter" data-level="10.3.7" data-path="analyze-familiar-word-recognition.html"><a href="analyze-familiar-word-recognition.html#relationship-with-child-level-variables"><i class="fa fa-check"></i><b>10.3.7</b> Relationship with child-level variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="visualize-looks-to-each-image-type.html"><a href="visualize-looks-to-each-image-type.html"><i class="fa fa-check"></i><b>11</b> Visualize looks to each image type</a><ul>
<li class="chapter" data-level="11.1" data-path="visualize-looks-to-each-image-type.html"><a href="visualize-looks-to-each-image-type.html#comparing-strong-versus-weak-foils"><i class="fa fa-check"></i><b>11.1</b> Comparing strong versus weak foils</a></li>
<li class="chapter" data-level="11.2" data-path="visualize-looks-to-each-image-type.html"><a href="visualize-looks-to-each-image-type.html#look-for-individual-differences-in-competitor-sensitivity"><i class="fa fa-check"></i><b>11.2</b> Look for individual differences in competitor sensitivity</a></li>
<li class="chapter" data-level="11.3" data-path="visualize-looks-to-each-image-type.html"><a href="visualize-looks-to-each-image-type.html#interim-summary-1"><i class="fa fa-check"></i><b>11.3</b> Interim summary</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="mp-experiment-items.html"><a href="mp-experiment-items.html"><i class="fa fa-check"></i><b>A</b> Items used in the mispronunciation experiment</a></li>
<li class="chapter" data-level="B" data-path="vw-experiment-items.html"><a href="vw-experiment-items.html"><i class="fa fa-check"></i><b>B</b> Items used in the visual world experiment</a></li>
<li class="chapter" data-level="C" data-path="related-work.html"><a href="related-work.html"><i class="fa fa-check"></i><b>C</b> Related Work</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Created with bookdown</a></li>
<li><a href="https://tjmahr.github.io/" target="blank">Tristan Mahr</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">My dissertation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analyze-familiar-word-recognition" class="section level1">
<h1><span class="header-section-number">Chapter 10</span> Analyze familiar word recognition</h1>
<p>Next steps:</p>
<ul>
<li>Model year over year changes.</li>
<li>Download test scores and individual differences.</li>
<li>Analyze individual differences</li>
</ul>
<div id="data-preparation-1" class="section level2">
<h2><span class="header-section-number">10.1</span> Data preparation</h2>
<p>Earlier we cleaned the data to remove trials with excessive missing data and blocks of trials with too few trials. Now we prepare the data for modelling.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_model &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">bin_width =</span> <span class="dv">3</span>,
  <span class="dt">start_time =</span> <span class="dv">250</span>,
  <span class="dt">end_time =</span> <span class="dv">1500</span>
)
opts_model<span class="op">$</span>bin_length &lt;-<span class="st"> </span><span class="kw">round</span>(opts_model<span class="op">$</span>bin_width <span class="op">*</span><span class="st"> </span><span class="fl">16.67</span>, <span class="op">-</span><span class="dv">1</span>)
opts_model
<span class="co">#&gt; $bin_width</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $start_time</span>
<span class="co">#&gt; [1] 250</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $end_time</span>
<span class="co">#&gt; [1] 1500</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $bin_length</span>
<span class="co">#&gt; [1] 50</span></code></pre></div>
<p>We next downsample the data into 50 ms (3-frame) bins in order to smooth the data. We will model the looks from 250 to 1500 ms, so we filter down to that time window. Lastly, we aggregate looks by child, study and time, and create orthogonal polynomials to use as time features for the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(<span class="st">&quot;./data/aim1-screened.csv.gz&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Study, ResearchID, TrialID<span class="op">:</span>GazeByImageAOI) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">assign_bins</span>(<span class="dt">bin_width =</span> opts_model<span class="op">$</span>bin_width, Time, TrialID)

<span class="co"># Compute time at center of each bin</span>
bin_times &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">distinct</span>(Time, .bin) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(.bin) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">BinTime =</span> <span class="kw">round</span>(<span class="kw">median</span>(Time), <span class="op">-</span><span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ungroup</span>()

<span class="co"># Attach bin times</span>
binned &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">left_join</span>(bin_times, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;.bin&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Time) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">Time =</span> BinTime) 

resp_def &lt;-<span class="st"> </span><span class="kw">create_response_def</span>(
  <span class="dt">primary =</span> <span class="st">&quot;Target&quot;</span>,
  <span class="dt">others =</span> <span class="kw">c</span>(<span class="st">&quot;PhonologicalFoil&quot;</span>, <span class="st">&quot;SemanticFoil&quot;</span>, <span class="st">&quot;Unrelated&quot;</span>),
  <span class="dt">elsewhere =</span> <span class="st">&quot;tracked&quot;</span>,
  <span class="dt">missing =</span> <span class="ot">NA</span>
)  
  
d &lt;-<span class="st"> </span>binned <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aggregate_looks</span>(resp_def, Study <span class="op">+</span><span class="st"> </span>ResearchID <span class="op">+</span><span class="st"> </span>Time <span class="op">~</span><span class="st"> </span>GazeByImageAOI)

d_m &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(opts_model<span class="op">$</span>start_time <span class="op">&lt;=</span><span class="st"> </span>Time, 
         Time <span class="op">&lt;=</span><span class="st"> </span>opts_model<span class="op">$</span>end_time) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>polypoly<span class="op">::</span><span class="kw">poly_add_columns</span>(Time, <span class="dt">degree =</span> <span class="dv">3</span>, 
                             <span class="dt">scale_width =</span> <span class="dv">1</span>, <span class="dt">prefix =</span> <span class="st">&quot;ot&quot;</span>)</code></pre></div>
<p>Plot the model-ready data. For this plot, we use the so-called <em>empirical logit</em> transformation because the regular logit (log-odds) generates too extreme of values for plotting.</p>
<p><img src="12-aim1-notebook_files/figure-html/spaghetti-elogit-1.png" width="100%" /></p>
<p>Those extreme lines indicate sparse data where there are zero-to-few looks to the distractors compared to the target. These are the 20 most extreme bins, to illustrate how empirical logit tames infinite values.</p>
<table>
<thead>
<tr class="header">
<th align="left">Study</th>
<th align="left">ResearchID</th>
<th align="right">Time</th>
<th align="right">Primary</th>
<th align="right">Others</th>
<th align="right">logit</th>
<th align="right">elogit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TimePoint2</td>
<td align="left">607L</td>
<td align="right">1300</td>
<td align="right">30</td>
<td align="right">0</td>
<td align="right">Inf</td>
<td align="right">4.11</td>
</tr>
<tr class="even">
<td align="left">TimePoint2</td>
<td align="left">607L</td>
<td align="right">1350</td>
<td align="right">29</td>
<td align="right">0</td>
<td align="right">Inf</td>
<td align="right">4.08</td>
</tr>
<tr class="odd">
<td align="left">TimePoint2</td>
<td align="left">640L</td>
<td align="right">1000</td>
<td align="right">33</td>
<td align="right">0</td>
<td align="right">Inf</td>
<td align="right">4.20</td>
</tr>
<tr class="even">
<td align="left">TimePoint2</td>
<td align="left">640L</td>
<td align="right">1050</td>
<td align="right">29</td>
<td align="right">0</td>
<td align="right">Inf</td>
<td align="right">4.08</td>
</tr>
<tr class="odd">
<td align="left">TimePoint2</td>
<td align="left">640L</td>
<td align="right">1100</td>
<td align="right">31</td>
<td align="right">0</td>
<td align="right">Inf</td>
<td align="right">4.14</td>
</tr>
<tr class="even">
<td align="left">TimePoint2</td>
<td align="left">640L</td>
<td align="right">1150</td>
<td align="right">30</td>
<td align="right">0</td>
<td align="right">Inf</td>
<td align="right">4.11</td>
</tr>
<tr class="odd">
<td align="left">TimePoint2</td>
<td align="left">640L</td>
<td align="right">1200</td>
<td align="right">27</td>
<td align="right">0</td>
<td align="right">Inf</td>
<td align="right">4.01</td>
</tr>
<tr class="even">
<td align="left">TimePoint2</td>
<td align="left">640L</td>
<td align="right">1250</td>
<td align="right">24</td>
<td align="right">0</td>
<td align="right">Inf</td>
<td align="right">3.89</td>
</tr>
<tr class="odd">
<td align="left">TimePoint2</td>
<td align="left">640L</td>
<td align="right">1300</td>
<td align="right">27</td>
<td align="right">0</td>
<td align="right">Inf</td>
<td align="right">4.01</td>
</tr>
<tr class="even">
<td align="left">TimePoint2</td>
<td align="left">640L</td>
<td align="right">1350</td>
<td align="right">26</td>
<td align="right">0</td>
<td align="right">Inf</td>
<td align="right">3.97</td>
</tr>
<tr class="odd">
<td align="left">TimePoint2</td>
<td align="left">640L</td>
<td align="right">1400</td>
<td align="right">28</td>
<td align="right">0</td>
<td align="right">Inf</td>
<td align="right">4.04</td>
</tr>
<tr class="even">
<td align="left">TimePoint2</td>
<td align="left">640L</td>
<td align="right">1450</td>
<td align="right">27</td>
<td align="right">0</td>
<td align="right">Inf</td>
<td align="right">4.01</td>
</tr>
<tr class="odd">
<td align="left">TimePoint2</td>
<td align="left">640L</td>
<td align="right">1500</td>
<td align="right">28</td>
<td align="right">0</td>
<td align="right">Inf</td>
<td align="right">4.04</td>
</tr>
<tr class="even">
<td align="left">TimePoint3</td>
<td align="left">014L</td>
<td align="right">1350</td>
<td align="right">58</td>
<td align="right">0</td>
<td align="right">Inf</td>
<td align="right">4.76</td>
</tr>
<tr class="odd">
<td align="left">TimePoint3</td>
<td align="left">014L</td>
<td align="right">1400</td>
<td align="right">53</td>
<td align="right">0</td>
<td align="right">Inf</td>
<td align="right">4.67</td>
</tr>
<tr class="even">
<td align="left">TimePoint3</td>
<td align="left">640L</td>
<td align="right">1300</td>
<td align="right">110</td>
<td align="right">1</td>
<td align="right">4.70</td>
<td align="right">4.30</td>
</tr>
<tr class="odd">
<td align="left">TimePoint3</td>
<td align="left">037L</td>
<td align="right">1350</td>
<td align="right">88</td>
<td align="right">1</td>
<td align="right">4.48</td>
<td align="right">4.08</td>
</tr>
<tr class="even">
<td align="left">TimePoint3</td>
<td align="left">037L</td>
<td align="right">1300</td>
<td align="right">87</td>
<td align="right">1</td>
<td align="right">4.47</td>
<td align="right">4.07</td>
</tr>
<tr class="odd">
<td align="left">TimePoint3</td>
<td align="left">037L</td>
<td align="right">1250</td>
<td align="right">84</td>
<td align="right">1</td>
<td align="right">4.43</td>
<td align="right">4.03</td>
</tr>
<tr class="even">
<td align="left">TimePoint3</td>
<td align="left">640L</td>
<td align="right">1100</td>
<td align="right">94</td>
<td align="right">2</td>
<td align="right">3.85</td>
<td align="right">3.63</td>
</tr>
</tbody>
</table>
</div>
<div id="maximum-likelihood-results" class="section level2">
<h2><span class="header-section-number">10.2</span> Maximum likelihood results</h2>
<p>Fit a maximum likelihood model as a first pass for the analysis. We won’t fit the model automatically (whenever this page is updated). It’s too time consuming. Instead, we do it manually here, and save the results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lme4)
m &lt;-<span class="st"> </span><span class="kw">glmer</span>(
    <span class="kw">cbind</span>(Primary, Others) <span class="op">~</span>
<span class="st">      </span>(ot1 <span class="op">+</span><span class="st"> </span>ot2 <span class="op">+</span><span class="st"> </span>ot3) <span class="op">*</span><span class="st"> </span>Study <span class="op">+</span>
<span class="st">      </span>(ot1 <span class="op">+</span><span class="st"> </span>ot2 <span class="op">+</span><span class="st"> </span>ot3 <span class="op">|</span><span class="st"> </span>ResearchID<span class="op">/</span>Study),
    <span class="dt">family =</span> binomial,
    <span class="dt">data =</span> d_m)
readr<span class="op">::</span><span class="kw">write_rds</span>(m, <span class="st">&quot;./data/aim1_cubic_model.rds.gz&quot;</span>)</code></pre></div>
<p>And reload the saved model here.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lme4)
<span class="co">#&gt; Loading required package: Matrix</span>
<span class="co">#&gt; Loading required package: methods</span>
m &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_rds</span>(<span class="st">&quot;./data/aim1_cubic_model.rds.gz&quot;</span>)
arm<span class="op">::</span><span class="kw">display</span>(m)
<span class="co">#&gt; glmer(formula = cbind(Primary, Others) ~ (ot1 + ot2 + ot3) * </span>
<span class="co">#&gt;     Study + (ot1 + ot2 + ot3 | ResearchID/Study), data = d_m, </span>
<span class="co">#&gt;     family = binomial)</span>
<span class="co">#&gt;                     coef.est coef.se</span>
<span class="co">#&gt; (Intercept)         -0.47     0.03  </span>
<span class="co">#&gt; ot1                  1.58     0.06  </span>
<span class="co">#&gt; ot2                  0.05     0.04  </span>
<span class="co">#&gt; ot3                 -0.17     0.03  </span>
<span class="co">#&gt; StudyTimePoint2      0.41     0.03  </span>
<span class="co">#&gt; StudyTimePoint3      0.70     0.04  </span>
<span class="co">#&gt; ot1:StudyTimePoint2  0.56     0.08  </span>
<span class="co">#&gt; ot1:StudyTimePoint3  1.10     0.08  </span>
<span class="co">#&gt; ot2:StudyTimePoint2 -0.16     0.05  </span>
<span class="co">#&gt; ot2:StudyTimePoint3 -0.35     0.05  </span>
<span class="co">#&gt; ot3:StudyTimePoint2 -0.12     0.04  </span>
<span class="co">#&gt; ot3:StudyTimePoint3 -0.21     0.04  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error terms:</span>
<span class="co">#&gt;  Groups           Name        Std.Dev. Corr              </span>
<span class="co">#&gt;  Study:ResearchID (Intercept) 0.30                       </span>
<span class="co">#&gt;                   ot1         0.68      0.18             </span>
<span class="co">#&gt;                   ot2         0.44     -0.12  0.03       </span>
<span class="co">#&gt;                   ot3         0.29     -0.09 -0.44 -0.05 </span>
<span class="co">#&gt;  ResearchID       (Intercept) 0.27                       </span>
<span class="co">#&gt;                   ot1         0.46      0.86             </span>
<span class="co">#&gt;                   ot2         0.09     -0.98 -0.84       </span>
<span class="co">#&gt;                   ot3         0.03     -0.92 -0.98  0.92 </span>
<span class="co">#&gt;  Residual                     1.00                       </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; number of obs: 12584, groups: Study:ResearchID, 484; ResearchID, 195</span>
<span class="co">#&gt; AIC = 74467.3, DIC = -61745.9</span>
<span class="co">#&gt; deviance = 6328.7</span>

d_m<span class="op">$</span>cubic_fit &lt;-<span class="st"> </span><span class="kw">fitted</span>(m)

<span class="kw">ggplot</span>(d_m) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> cubic_fit) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> ResearchID), <span class="dt">alpha =</span> .<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Study) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(
      <span class="dt">x =</span> <span class="st">&quot;Time after target onset (smoothed to 50 ms bins)&quot;</span>,
      <span class="dt">y =</span> <span class="st">&quot;Proportion looks to target (fitted)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_grey</span>(<span class="dt">base_size =</span> <span class="dv">9</span>) </code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/cubic-model-fits-1.png" width="100%" /></p>
<div id="whats-being-captured-by-the-random-effects" class="section level3">
<h3><span class="header-section-number">10.2.1</span> What’s being captured by the random effects?</h3>
<p>First, let’s plot just the fixed effect predictions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">predict_y &lt;-<span class="st"> </span><span class="cf">function</span>(...) <span class="kw">predict</span>(..., <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)
d_m<span class="op">$</span>fixef_fit &lt;-<span class="st"> </span><span class="kw">predict_y</span>(m, <span class="dt">re.form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>)
d_m<span class="op">$</span>subj_fit  &lt;-<span class="st"> </span><span class="kw">predict_y</span>(m, <span class="dt">re.form =</span> <span class="op">~</span><span class="st"> </span>(ot1 <span class="op">+</span><span class="st"> </span>ot2 <span class="op">+</span><span class="st"> </span>ot3 <span class="op">|</span><span class="st"> </span>ResearchID))
d_m<span class="op">$</span>study_fit &lt;-<span class="st"> </span><span class="kw">predict_y</span>(m, <span class="dt">re.form =</span> <span class="op">~</span><span class="st"> </span>(ot1 <span class="op">+</span><span class="st"> </span>ot2 <span class="op">+</span><span class="st"> </span>ot3 <span class="op">|</span><span class="st"> </span>Study<span class="op">:</span>ResearchID))
d_m<span class="op">$</span>full_fit  &lt;-<span class="st"> </span><span class="kw">predict_y</span>(m, <span class="dt">re.form =</span> <span class="op">~</span><span class="st"> </span>(ot1 <span class="op">+</span><span class="st"> </span>ot2 <span class="op">+</span><span class="st"> </span>ot3 <span class="op">|</span><span class="st"> </span>Study<span class="op">:</span>ResearchID) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(ot1 <span class="op">+</span><span class="st"> </span>ot2 <span class="op">+</span><span class="st"> </span>ot3 <span class="op">|</span><span class="st"> </span>ResearchID))

<span class="kw">ggplot</span>(d_m) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> fixef_fit) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> ResearchID), <span class="dt">alpha =</span> .<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Study) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_grey</span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">x =</span> <span class="st">&quot;Time after target onset (smoothed to 50 ms bins)&quot;</span>,
    <span class="dt">y =</span> <span class="st">&quot;Proportion looks to target (fitted)&quot;</span>,
    <span class="dt">caption =</span> <span class="st">&quot;Conditioned on no random effects&quot;</span>) </code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/cubic-model-fits-fixes-1.png" width="100%" /></p>
<p>Now, we condition on child level effects.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d_m) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> subj_fit) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> ResearchID), <span class="dt">alpha =</span> .<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Study) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_grey</span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">x =</span> <span class="st">&quot;Time after target onset (smoothed to 50 ms bins)&quot;</span>,
    <span class="dt">y =</span> <span class="st">&quot;Proportion looks to target (fitted)&quot;</span>,
    <span class="dt">caption =</span> <span class="st">&quot;Conditioned on Child effects&quot;</span>) </code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/cubic-model-fits-child-efs-1.png" width="100%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(d_m) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> subj_fit <span class="op">-</span><span class="st"> </span>fixef_fit) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> ResearchID), <span class="dt">alpha =</span> .<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Study) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_grey</span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">x =</span> <span class="st">&quot;Time after target onset (smoothed to 50 ms bins)&quot;</span>,
    <span class="dt">y =</span> <span class="st">&quot;Child-conditioned minus study means&quot;</span>) </code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/cubic-model-fits-child-efs-2.png" width="100%" /></p>
<p>It looks like the range of y values is smaller in TimePoint2 and TimePoint3, but could that just be the different numbers of participants who contribute to each study?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d_m <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">distinct</span>(ResearchID, Study) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">count</span>(Study) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="st">`</span><span class="dt">Num children in model</span><span class="st">`</span> =<span class="st"> </span>n) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Study</th>
<th align="right">Num children in model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TimePoint1</td>
<td align="right">163</td>
</tr>
<tr class="even">
<td align="left">TimePoint2</td>
<td align="right">165</td>
</tr>
<tr class="odd">
<td align="left">TimePoint3</td>
<td align="right">156</td>
</tr>
</tbody>
</table>
<p>Now we condition on Study x Child effects. These would be capturing the subject-x-study variability.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d_m) <span class="op">+</span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> study_fit) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> ResearchID), <span class="dt">alpha =</span> .<span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Study) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_grey</span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">x =</span> <span class="st">&quot;Time after target onset (smoothed to 50 ms bins)&quot;</span>,
    <span class="dt">y =</span> <span class="st">&quot;Proportion looks to target (fitted)&quot;</span>,
    <span class="dt">caption =</span> <span class="st">&quot;Conditioned on Study x Child effects&quot;</span>)</code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/cubic-model-fits-ranefs-1.png" width="100%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(d_m) <span class="op">+</span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> study_fit <span class="op">-</span><span class="st"> </span>fixef_fit) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> ResearchID), <span class="dt">alpha =</span> .<span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Study) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_grey</span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">x =</span> <span class="st">&quot;Time after target onset (smoothed to 50 ms bins)&quot;</span>,
    <span class="dt">y =</span> <span class="st">&quot;Child-x-Study-conditioned minus study means&quot;</span>)</code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/cubic-model-fits-ranefs-2.png" width="100%" /></p>
<p>Look for weak spots in the time series.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d_corr &lt;-<span class="st"> </span>d_m <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Time, Study) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">r =</span> <span class="kw">cor</span>(Prop, cubic_fit)) 

<span class="kw">ggplot</span>(d_corr) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> r, <span class="dt">color =</span> Study) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="kw">c</span>(.<span class="dv">8</span>, <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">x =</span> <span class="st">&quot;Time after target onset (smoothed to 50 ms bins)&quot;</span>,
    <span class="dt">y =</span> <span class="st">&quot;Correlation of fitted and observed&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_grey</span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(
    <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>), 
    <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) </code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/cubic-model-raw-fit-corr-1.png" width="50%" /></p>
<p>Rank the participants by their growth curve parameters—that is, the growth curve features when conditioned on child ID.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xstudy_effects &lt;-<span class="st"> </span>m <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ranef</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">getElement</span>(<span class="st">&quot;ResearchID&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tibble<span class="op">::</span><span class="kw">rownames_to_column</span>(<span class="st">&quot;ResearchID&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(ResearchID, <span class="dt">intercept =</span> <span class="st">`</span><span class="dt">(Intercept)</span><span class="st">`</span>, <span class="dt">slope =</span> ot1)

top_<span class="dv">20</span> &lt;-<span class="st"> </span><span class="kw">top_n</span>(xstudy_effects, <span class="dv">20</span>, slope)
bot_<span class="dv">20</span> &lt;-<span class="st"> </span><span class="kw">top_n</span>(xstudy_effects, <span class="dv">20</span>, <span class="op">-</span>slope)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d_m <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Study <span class="op">==</span><span class="st"> &quot;TimePoint2&quot;</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> subj_fit) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> ResearchID), <span class="dt">alpha =</span> .<span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> ResearchID), 
            <span class="dt">data =</span> <span class="kw">semi_join</span>(d_m, top_<span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Study <span class="op">==</span><span class="st"> &quot;TimePoint2&quot;</span>), 
            <span class="dt">size =</span> .<span class="dv">7</span>, <span class="dt">color =</span> <span class="st">&quot;#0074D9&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> ResearchID), 
            <span class="dt">data =</span> <span class="kw">semi_join</span>(d_m, bot_<span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Study <span class="op">==</span><span class="st"> &quot;TimePoint2&quot;</span>), 
            <span class="dt">size =</span> .<span class="dv">7</span>, <span class="dt">color =</span> <span class="st">&quot;#FF4136&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_grey</span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;TP2 fits conditioned on Child effects&quot;</span>, 
       <span class="dt">x =</span> <span class="st">&quot;Time after target onset (smoothed to 50 ms bins)&quot;</span>,
       <span class="dt">caption =</span> <span class="st">&quot;Colors: Top 20 and bottom 20 children by linear time effect&quot;</span>)
<span class="co">#&gt; Joining, by = &quot;ResearchID&quot;</span>
<span class="co">#&gt; Joining, by = &quot;ResearchID&quot;</span></code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/cubic-model-fits-child-efs-ranks-1.png" width="50%" /></p>
<p>Visualize the model fits for the top and bottom 20 children. This plot illustrates that the children with strongest and weakest linear time components overall stay clustered away from each other when looking study level predictions. That is, the top 20 in general perform bunch together in all three studies.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d_m) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> cubic_fit) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> ResearchID), <span class="dt">alpha =</span> .<span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> ResearchID), <span class="dt">data =</span> <span class="kw">semi_join</span>(d_m, top_<span class="dv">20</span>), 
            <span class="dt">size =</span> .<span class="dv">7</span>, <span class="dt">color =</span> <span class="st">&quot;#0074D9&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> ResearchID), <span class="dt">data =</span> <span class="kw">semi_join</span>(d_m, bot_<span class="dv">20</span>), 
            <span class="dt">size =</span> .<span class="dv">7</span>, <span class="dt">color =</span> <span class="st">&quot;#FF4136&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Study) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_grey</span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Proportion looks to target [model fits]&quot;</span>, 
       <span class="dt">x =</span> <span class="st">&quot;Time after target onset (smoothed to 50 ms bins)&quot;</span>,
       <span class="dt">caption =</span> <span class="st">&quot;Colors: Top 20 and bottom 20 children by linear time effect&quot;</span>)
<span class="co">#&gt; Joining, by = &quot;ResearchID&quot;</span>
<span class="co">#&gt; Joining, by = &quot;ResearchID&quot;</span></code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/ranks-1.png" width="100%" /></p>
<p>To confirm that this differences are not just an artifact of modeling, visualize the ranks on the observed data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(d_m) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Prop) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> ResearchID), <span class="dt">alpha =</span> .<span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> ResearchID), <span class="dt">data =</span> <span class="kw">semi_join</span>(d_m, top_<span class="dv">20</span>), 
            <span class="dt">size =</span> .<span class="dv">7</span>, <span class="dt">color =</span> <span class="st">&quot;#0074D9&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> ResearchID), <span class="dt">data =</span> <span class="kw">semi_join</span>(d_m, bot_<span class="dv">20</span>), 
            <span class="dt">size =</span> .<span class="dv">7</span>, <span class="dt">color =</span> <span class="st">&quot;#FF4136&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Study) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Proportion looks to target&quot;</span>, 
       <span class="dt">x =</span> <span class="st">&quot;Time after target onset (smoothed to 50 ms bins)&quot;</span>,
       <span class="dt">caption =</span> <span class="st">&quot;Colors: Top 20 and bottom 20 children by linear time effect&quot;</span>)
<span class="co">#&gt; Joining, by = &quot;ResearchID&quot;</span>
<span class="co">#&gt; Joining, by = &quot;ResearchID&quot;</span></code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/ranks-on-raw-1.png" width="100%" /></p>
<p>Open questions:</p>
<ul>
<li>How to test for stability of individual differences over time?</li>
<li>Intuitively, I would say that the differences are unstable if the red and blue lines got shuffled in each study. What stats formalize this intuition?</li>
</ul>
</div>
</div>
<div id="bayesian-model-results" class="section level2">
<h2><span class="header-section-number">10.3</span> Bayesian model results</h2>
<p>Here is the code used to fit the model with Stan. It took about 24 hours to run the model. The regression terms have the prior Normal(0, 1)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rstanarm)
<span class="kw">options</span>(<span class="dt">mc.cores =</span> parallel<span class="op">::</span><span class="kw">detectCores</span>())

m &lt;-<span class="st"> </span><span class="kw">stan_glmer</span>(
  <span class="kw">cbind</span>(Primary, Others) <span class="op">~</span>
<span class="st">    </span>(ot1 <span class="op">+</span><span class="st"> </span>ot2 <span class="op">+</span><span class="st"> </span>ot3) <span class="op">*</span><span class="st"> </span>Study <span class="op">+</span>
<span class="st">    </span>(ot1 <span class="op">+</span><span class="st"> </span>ot2 <span class="op">+</span><span class="st"> </span>ot3 <span class="op">|</span><span class="st"> </span>ResearchID<span class="op">/</span>Study),
  <span class="dt">family =</span> binomial,
  <span class="dt">prior =</span> <span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>),
  <span class="dt">prior_intercept =</span> <span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>),
  <span class="dt">prior_covariance =</span> <span class="kw">decov</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>),
  <span class="dt">data =</span> d_m)
readr<span class="op">::</span><span class="kw">write_rds</span>(m, <span class="st">&quot;./data/stan_aim1_cubic_model.rds.gz&quot;</span>)</code></pre></div>
<p>Let’s try to understand our model by making some plots.</p>
<div id="fixed-effects-plots" class="section level3">
<h3><span class="header-section-number">10.3.1</span> Fixed effects plots</h3>
<p>First, let’s prepare to plot the intervals for the fixed effects.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rstanarm)
<span class="co">#&gt; Loading required package: Rcpp</span>
<span class="co">#&gt; rstanarm (Version 2.15.3, packaged: 2017-04-29 06:18:44 UTC)</span>
<span class="co">#&gt; - Do not expect the default priors to remain the same in future rstanarm versions.</span>
<span class="co">#&gt; Thus, R scripts should specify priors explicitly, even if they are just the defaults.</span>
<span class="co">#&gt; - For execution on a local, multicore CPU with excess RAM we recommend calling</span>
<span class="co">#&gt; options(mc.cores = parallel::detectCores())</span>
<span class="kw">library</span>(bayesplot)
<span class="co">#&gt; This is bayesplot version 1.4.0.9000</span>
<span class="co">#&gt; - Plotting theme set to bayesplot::theme_default()</span>
<span class="co">#&gt; - Online documentation at mc-stan.org/bayesplot</span>
<span class="kw">theme_set</span>(<span class="kw">theme_grey</span>())
<span class="kw">library</span>(stringr)
<span class="kw">library</span>(ggstance)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: &#39;ggstance&#39;</span>
<span class="co">#&gt; The following objects are masked from &#39;package:ggplot2&#39;:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     geom_errorbarh, GeomErrorbarh</span>
parse_text &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">parse</span>(<span class="dt">text =</span> x)

b &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_rds</span>(<span class="st">&quot;./data/stan_aim1_cubic_model.rds.gz&quot;</span>)
b
<span class="co">#&gt; stan_glmer</span>
<span class="co">#&gt;  family:  binomial [logit]</span>
<span class="co">#&gt;  formula: cbind(Primary, Others) ~ (ot1 + ot2 + ot3) * Study + (ot1 + ot2 + </span>
<span class="co">#&gt;     ot3 | ResearchID/Study)</span>
<span class="co">#&gt; ------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates:</span>
<span class="co">#&gt;                     Median MAD_SD</span>
<span class="co">#&gt; (Intercept)         -0.5    0.0  </span>
<span class="co">#&gt; ot1                  1.6    0.1  </span>
<span class="co">#&gt; ot2                  0.0    0.0  </span>
<span class="co">#&gt; ot3                 -0.2    0.0  </span>
<span class="co">#&gt; StudyTimePoint2      0.4    0.0  </span>
<span class="co">#&gt; StudyTimePoint3      0.7    0.0  </span>
<span class="co">#&gt; ot1:StudyTimePoint2  0.6    0.1  </span>
<span class="co">#&gt; ot1:StudyTimePoint3  1.1    0.1  </span>
<span class="co">#&gt; ot2:StudyTimePoint2 -0.2    0.0  </span>
<span class="co">#&gt; ot2:StudyTimePoint3 -0.4    0.1  </span>
<span class="co">#&gt; ot3:StudyTimePoint2 -0.1    0.0  </span>
<span class="co">#&gt; ot3:StudyTimePoint3 -0.2    0.0  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error terms:</span>
<span class="co">#&gt;  Groups           Name        Std.Dev. Corr             </span>
<span class="co">#&gt;  Study:ResearchID (Intercept) 0.305                     </span>
<span class="co">#&gt;                   ot1         0.691     0.20            </span>
<span class="co">#&gt;                   ot2         0.437    -0.11  0.02      </span>
<span class="co">#&gt;                   ot3         0.294    -0.11 -0.44 -0.06</span>
<span class="co">#&gt;  ResearchID       (Intercept) 0.264                     </span>
<span class="co">#&gt;                   ot1         0.423     0.78            </span>
<span class="co">#&gt;                   ot2         0.125    -0.75 -0.56      </span>
<span class="co">#&gt;                   ot3         0.058    -0.23 -0.31  0.19</span>
<span class="co">#&gt; Num. levels: Study:ResearchID 484, ResearchID 195 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sample avg. posterior predictive </span>
<span class="co">#&gt; distribution of y (X = xbar):</span>
<span class="co">#&gt;          Median MAD_SD</span>
<span class="co">#&gt; mean_PPD 49.9    0.1  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ------</span>
<span class="co">#&gt; For info on the priors used see help(&#39;prior_summary.stanreg&#39;).</span>

<span class="kw">summary</span>(b, <span class="dt">pars =</span> <span class="kw">names</span>(<span class="kw">fixef</span>(b)))
<span class="co">#&gt; </span>
<span class="co">#&gt; Model Info:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  function:  stan_glmer</span>
<span class="co">#&gt;  family:    binomial [logit]</span>
<span class="co">#&gt;  formula:   cbind(Primary, Others) ~ (ot1 + ot2 + ot3) * Study + (ot1 + ot2 + </span>
<span class="co">#&gt;     ot3 | ResearchID/Study)</span>
<span class="co">#&gt;  algorithm: sampling</span>
<span class="co">#&gt;  priors:    see help(&#39;prior_summary&#39;)</span>
<span class="co">#&gt;  sample:    4000 (posterior sample size)</span>
<span class="co">#&gt;  num obs:   12584</span>
<span class="co">#&gt;  groups:    Study:ResearchID (484), ResearchID (195)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates:</span>
<span class="co">#&gt;                       mean   sd   2.5%   25%   50%   75%   97.5%</span>
<span class="co">#&gt; (Intercept)         -0.5    0.0 -0.5   -0.5  -0.5  -0.4  -0.4   </span>
<span class="co">#&gt; ot1                  1.6    0.1  1.4    1.5   1.6   1.6   1.7   </span>
<span class="co">#&gt; ot2                  0.0    0.0  0.0    0.0   0.0   0.1   0.1   </span>
<span class="co">#&gt; ot3                 -0.2    0.0 -0.2   -0.2  -0.2  -0.2  -0.1   </span>
<span class="co">#&gt; StudyTimePoint2      0.4    0.0  0.3    0.4   0.4   0.4   0.5   </span>
<span class="co">#&gt; StudyTimePoint3      0.7    0.0  0.6    0.7   0.7   0.7   0.8   </span>
<span class="co">#&gt; ot1:StudyTimePoint2  0.6    0.1  0.4    0.5   0.6   0.6   0.7   </span>
<span class="co">#&gt; ot1:StudyTimePoint3  1.1    0.1  0.9    1.0   1.1   1.2   1.3   </span>
<span class="co">#&gt; ot2:StudyTimePoint2 -0.2    0.1 -0.3   -0.2  -0.2  -0.1  -0.1   </span>
<span class="co">#&gt; ot2:StudyTimePoint3 -0.4    0.1 -0.5   -0.4  -0.4  -0.3  -0.3   </span>
<span class="co">#&gt; ot3:StudyTimePoint2 -0.1    0.0 -0.2   -0.1  -0.1  -0.1   0.0   </span>
<span class="co">#&gt; ot3:StudyTimePoint3 -0.2    0.0 -0.3   -0.2  -0.2  -0.2  -0.1   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Diagnostics:</span>
<span class="co">#&gt;                     mcse Rhat n_eff</span>
<span class="co">#&gt; (Intercept)         0.0  1.0  1086 </span>
<span class="co">#&gt; ot1                 0.0  1.0   857 </span>
<span class="co">#&gt; ot2                 0.0  1.0   842 </span>
<span class="co">#&gt; ot3                 0.0  1.0  1156 </span>
<span class="co">#&gt; StudyTimePoint2     0.0  1.0  1034 </span>
<span class="co">#&gt; StudyTimePoint3     0.0  1.0   959 </span>
<span class="co">#&gt; ot1:StudyTimePoint2 0.0  1.0   674 </span>
<span class="co">#&gt; ot1:StudyTimePoint3 0.0  1.0   934 </span>
<span class="co">#&gt; ot2:StudyTimePoint2 0.0  1.0   836 </span>
<span class="co">#&gt; ot2:StudyTimePoint3 0.0  1.0   762 </span>
<span class="co">#&gt; ot3:StudyTimePoint2 0.0  1.0  1183 </span>
<span class="co">#&gt; ot3:StudyTimePoint3 0.0  1.0  1390 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</span>

<span class="kw">prior_summary</span>(b)
<span class="co">#&gt; Priors for model &#39;b&#39; </span>
<span class="co">#&gt; ------</span>
<span class="co">#&gt; Intercept (after predictors centered)</span>
<span class="co">#&gt;  ~ normal(location = 0, scale = 5)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients</span>
<span class="co">#&gt;  ~ normal(location = [0,0,0,...], scale = [1,1,1,...])</span>
<span class="co">#&gt;      **adjusted scale = [3.33,3.33,3.33,...]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Covariance</span>
<span class="co">#&gt;  ~ decov(reg. = 2, conc. = 1, shape = 1, scale = 1)</span>
<span class="co">#&gt; ------</span>
<span class="co">#&gt; See help(&#39;prior_summary.stanreg&#39;) for more details</span></code></pre></div>
<p>Below the TimePoint2, TimePoint3, Time x TimePoint2, and Time x TimePoint3 effects confirm that children get more reliable and faster each year of the study. Only the Time<sup>2</sup> effect is near 0, which does not matter. We mostly care about the intercept and time terms.</p>
<p><img src="12-aim1-notebook_files/figure-html/effects1-1.png" width="80%" /></p>
<p>Now, let’s undo interactions by adding year 1 main effects to interaction effects and plot the effects for each year of the study. For each effect, there appears to be a linear trend in the change from TP1 to TP2 and from TP2 to TP3.</p>
<p><img src="12-aim1-notebook_files/figure-html/effects2-1.png" width="80%" /></p>
<p>Compute pairwise comparisons.</p>
<p><img src="12-aim1-notebook_files/figure-html/pairwise-effects-1.png" width="80%" /></p>
<p>Bayesplot supports transformations so we could invert the log-odds measure to see the intercepts (area under curve/average accuracy) in proportion units.</p>
<table>
<thead>
<tr class="header">
<th align="left">parameter</th>
<th align="right">outer</th>
<th align="right">inner</th>
<th align="right">ll</th>
<th align="right">l</th>
<th align="right">m</th>
<th align="right">h</th>
<th align="right">hh</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">plogis(Intercept~~(TP1))</td>
<td align="right">0.9</td>
<td align="right">0.5</td>
<td align="right">0.372</td>
<td align="right">0.380</td>
<td align="right">0.385</td>
<td align="right">0.390</td>
<td align="right">0.397</td>
</tr>
<tr class="even">
<td align="left">plogis(Intercept~~(TP2))</td>
<td align="right">0.9</td>
<td align="right">0.5</td>
<td align="right">0.473</td>
<td align="right">0.480</td>
<td align="right">0.485</td>
<td align="right">0.490</td>
<td align="right">0.498</td>
</tr>
<tr class="odd">
<td align="left">plogis(Intercept~~(TP3))</td>
<td align="right">0.9</td>
<td align="right">0.5</td>
<td align="right">0.544</td>
<td align="right">0.551</td>
<td align="right">0.557</td>
<td align="right">0.562</td>
<td align="right">0.569</td>
</tr>
</tbody>
</table>
<p><img src="12-aim1-notebook_files/figure-html/intercepts-1.png" width="60%" /></p>
<p>We can compute differences in average accuracy as well.</p>
<p><img src="12-aim1-notebook_files/figure-html/intercept-differences-1.png" width="60%" /></p>
<p>The average accuracy was 0.385 [90% UI: 0.372–0.397] for timepoint 1, 0.485 [0.473–0.498] for timepoint 2, and 0.557 [0.544–0.569] for timepoint 3. The average accuracy increased by 0.1 [0.087–0.114] from timepoint 1 to timepoint 2 and by 0.072 [0.058–0.085] from timepoint 2 to timepoint 3.</p>
</div>
<div id="plot-the-intervals-for-the-random-effect-parameters" class="section level3">
<h3><span class="header-section-number">10.3.2</span> Plot the intervals for the random effect parameters</h3>
<p>These are the parameters governing the random effect distributions. First, we plot the standard deviations.</p>
<p><img src="12-aim1-notebook_files/figure-html/posterior-sds-1.png" width="80%" /></p>
<p>Then the correlations.</p>
<p><img src="12-aim1-notebook_files/figure-html/posterior-cors-1.png" width="80%" /></p>
</div>
<div id="check-for-stable-individual-differences" class="section level3">
<h3><span class="header-section-number">10.3.3</span> Check for stable individual differences</h3>
<p>We predicted that children would show stable individual differences such that children who are faster and more accurate at recognizing words at age 3 remain relatively faster and more accurate at age 5. To evaluate this hypothesis, we used Kendall’s <em>W</em> (the coefficient of correspondence or concordance). This nonparametric statistic measures the degree of agreement among <em>J</em> judges who are rating <em>I</em> items. For our purposes, the items are the 123 children who provided reliable eyetracking for all three years of the study. (That is, we excluded children who only had reliable eyetracking data for one or two years.) The judges are the sets of growth curve parameters from each year of study. For example, the intercept term provides three sets of ratings: The participants’ intercept terms from year 1 are one set of ratings and the terms from years 2 and 3 provide two more sets of ratings. These three ratings are the “judges” used to compute the intercept’s <em>W</em>. Thus, we compute four sets of <em>W</em> coefficients, one for each set of growth curve features: Intercept, Time<sup>1</sup>, Time<sup>2</sup>, and Time<sup>3</sup>.</p>
<p>(Maybe: Table X illustrates some sample ratings of these participants.)</p>
<table>
<thead>
<tr class="header">
<th align="left">Participant ID</th>
<th align="left">Growth curve feature</th>
<th align="right">Year 1</th>
<th align="right">Year 2</th>
<th align="right">Year 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">640L</td>
<td align="left">intercept</td>
<td align="right">0.09 (006)</td>
<td align="right">1.78 (001)</td>
<td align="right">1.53 (001)</td>
</tr>
<tr class="even">
<td align="left">040L</td>
<td align="left">intercept</td>
<td align="right">0.02 (009)</td>
<td align="right">0.31 (017)</td>
<td align="right">1.18 (002)</td>
</tr>
<tr class="odd">
<td align="left">080L</td>
<td align="left">intercept</td>
<td align="right">−0.02 (013)</td>
<td align="right">0.77 (005)</td>
<td align="right">1.09 (003)</td>
</tr>
<tr class="even">
<td align="left">037L</td>
<td align="left">intercept</td>
<td align="right">−0.33 (052)</td>
<td align="right">−0.03 (060)</td>
<td align="right">0.95 (004)</td>
</tr>
<tr class="odd">
<td align="left">043L</td>
<td align="left">intercept</td>
<td align="right">0.22 (002)</td>
<td align="right">0.87 (003)</td>
<td align="right">0.94 (005)</td>
</tr>
<tr class="even">
<td align="left">050L</td>
<td align="left">intercept</td>
<td align="right">−0.39 (063)</td>
<td align="right">0.45 (008)</td>
<td align="right">0.92 (006)</td>
</tr>
<tr class="odd">
<td align="left">014L</td>
<td align="left">intercept</td>
<td align="right">−0.06 (015)</td>
<td align="right">0.05 (047)</td>
<td align="right">0.92 (007)</td>
</tr>
<tr class="even">
<td align="left">090L</td>
<td align="left">intercept</td>
<td align="right">−0.10 (019)</td>
<td align="right">−0.20 (088)</td>
<td align="right">0.90 (008)</td>
</tr>
<tr class="odd">
<td align="left">106L</td>
<td align="left">intercept</td>
<td align="right">−0.06 (016)</td>
<td align="right">0.88 (002)</td>
<td align="right">0.86 (009)</td>
</tr>
<tr class="even">
<td align="left">674L</td>
<td align="left">intercept</td>
<td align="right">−0.03 (014)</td>
<td align="right">0.21 (024)</td>
<td align="right">0.79 (010)</td>
</tr>
</tbody>
</table>
<p>Because we used a Bayesian model, we have a distribution of ratings and thus a distribution of concordance statistics. Each sample of the posterior distribution fits a growth curve for each child in each study, so each sample provides a set of ratings for concordance coefficients. The distribution of <em>W</em>’s lets us quantify our uncertainty because we can compute <em>W</em>’s for each of the 4000 samples from the posterior distribution.</p>
<p>One final matter is how do we assess whether a concordance statistic is meaningful. To tackle this question, we also included a “null rater”, a fake parameter that assigned each child in each year a random number. We can use the distribution of <em>W</em>’s generated by randomly rating children as a benchmark for assessing whether the other concordance statistics differ meaningfully from chance.</p>
<p>We used the <code>kendall()</code> function in the <code>irr</code> package (vers. 0.84, CITATION) to compute concordance statistics.</p>

<div class="figure"><span id="fig:kendall-stats"></span>
<img src="12-aim1-notebook_files/figure-html/kendall-stats-1.png" alt="Uncertainty intervals for the Kendall’s coefficient of concordance. Random ratings provide a baseline of null W statistics. The intercept and linear time features are decisively non-null, indicating a significant degree of correspondence in children’s relative word recognition reliability and efficiency over three years of study." width="80%" />
<p class="caption">
Figure 10.1: Uncertainty intervals for the Kendall’s coefficient of concordance. Random ratings provide a baseline of null <em>W</em> statistics. The intercept and linear time features are decisively non-null, indicating a significant degree of correspondence in children’s relative word recognition reliability and efficiency over three years of study.
</p>
</div>
<p>Figure <a href="analyze-familiar-word-recognition.html#fig:kendall-stats">10.1</a> depicts uncertainty intervals for the Kendall <em>W</em>’s for these growth curve features. The 90% uncertainty interval of <em>W</em> statistics from random ratings [0.275–0.392] subsumes the intervals for the Time<sup>2</sup> effect [0.295–0.351] and the Time<sup>3</sup> effect [0.276–0.348], indicating that these values do not differentiate children in a longitudinally stable way. That is, the Time<sup>2</sup> and Time<sup>3</sup> features differentiate children across studies as well as random numbers. Earlier, we stated that only the intercept and linear terms have psychologically meaningful interpretations and that the higher-order terms of these models serve to capture the shape of the growth curve data. These statistics support that assertion.</p>
<p>Concordance is strongest for the intercept term, <em>W</em> = 0.585 [0.573–0.596] followed by the linear time term, <em>W</em> = <code>r w_pts[[&quot;Time&quot;]]</code> [0.483–0.518]. Because these values are from the statistics for random ratings, we conclude that there is a credible degree of correspondence across studies when we rank children using their average accuracy (the intercept) or their growth curve slope (linear time).</p>
<div id="summary-of-this-section" class="section level4">
<h4><span class="header-section-number">10.3.3.1</span> Summary of this section</h4>
<p>Growth curve features reflect individual differences in word recognition efficiency and accuracy. By using Kendall’s <em>W</em> to measure the degree of concordance among growth curve features over time, we can measure whether individual differences in lexical processing are stable over time. We found that the intercept and linear time terms were stable over time.</p>
</div>
</div>
<div id="posterior-predictive-checks" class="section level3">
<h3><span class="header-section-number">10.3.4</span> Posterior predictive checks</h3>
<p>Next, we let’s check how well the model can simulate the observed data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rstanarm<span class="op">::</span><span class="kw">pp_check</span>(b, <span class="dt">nreps =</span> <span class="dv">200</span>, <span class="dt">seed =</span> <span class="st">&quot;09272017&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">x =</span> <span class="st">&quot;Proportion of looks&quot;</span>, 
    <span class="dt">title =</span> <span class="st">&quot;Observed data and 200 posterior simulations&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/post-pred-1.png" width="80%" /></p>
</div>
<div id="look-at-some-predictions" class="section level3">
<h3><span class="header-section-number">10.3.5</span> Look at some predictions</h3>
<p>Plot the posterior predictions for random participants. This is the model simulating new data for these participants.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">09272017</span>)

ppred &lt;-<span class="st"> </span>d_m <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">sample_n_of</span>(<span class="dv">8</span>, ResearchID) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tristan<span class="op">::</span><span class="kw">augment_posterior_predict</span>(b, <span class="dt">newdata =</span> ., <span class="dt">nsamples =</span> <span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">trials =</span> Primary <span class="op">+</span><span class="st"> </span>Others)

<span class="kw">ggplot</span>(ppred) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Prop, <span class="dt">color =</span> Study, <span class="dt">group =</span> Study) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> .posterior_value <span class="op">/</span><span class="st"> </span>trials, 
                <span class="dt">group =</span> <span class="kw">interaction</span>(.draw, Study)), 
            <span class="dt">alpha =</span> .<span class="dv">20</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;ResearchID&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(
    <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="dv">0</span>), 
    <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),
    <span class="dt">legend.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="ot">NULL</span>, <span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>))) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">title =</span> <span class="st">&quot;Observed means and 100 simulations of new data&quot;</span>,
    <span class="dt">x =</span> <span class="st">&quot;Time after target onset&quot;</span>,
    <span class="dt">y =</span> <span class="st">&quot;Proportion looks to target&quot;</span>) </code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/posterior-lines-1.png" width="100%" /></p>
<p>Or we can plot the linear predictions. These are posterior predictions of the log-odds of looking to target before adding binomial noise.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lpred &lt;-<span class="st"> </span>d_m <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">sample_n_of</span>(<span class="dv">8</span>, ResearchID) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tristan<span class="op">::</span><span class="kw">augment_posterior_linpred</span>(b, <span class="dt">newdata =</span> ., <span class="dt">nsamples =</span> <span class="dv">100</span>)

<span class="kw">ggplot</span>(lpred) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> .posterior_value, <span class="dt">color =</span> Study) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> <span class="kw">interaction</span>(Study, ResearchID, .draw)), 
            <span class="dt">alpha =</span> .<span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;ResearchID&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">qlogis</span>(Prop)), <span class="dt">shape =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(
    <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="dv">0</span>), 
    <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),
    <span class="dt">legend.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="ot">NULL</span>, <span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>))) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">title =</span> <span class="st">&quot;Observed data and 100 posterior predictions&quot;</span>,
    <span class="dt">x =</span> <span class="st">&quot;Time after target onset&quot;</span>,
    <span class="dt">y =</span> <span class="st">&quot;Posterior log-odds&quot;</span>)</code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/posterior-mean-lines-1.png" width="100%" /></p>
<p>We can also consider predictions for hypothetical, new children as well. This procedure lets us explore the range of variability in performance at each age. In this case, the model has learned to predict less accurate and more spread out performance at age 3, and improved accuaracy and decreased variability at age 4 and moreso at age 5.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dummy_data &lt;-<span class="st"> </span>d_m <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">distinct</span>(Study, Time, ot1, ot2, ot3) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ResearchID =</span> <span class="st">&quot;NEW&quot;</span>,
         <span class="dt">Primary =</span> <span class="dv">0</span>, 
         <span class="dt">Others =</span> <span class="dv">0</span>)

lpred &lt;-<span class="st"> </span>dummy_data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tristan<span class="op">::</span><span class="kw">augment_posterior_linpred</span>(b, <span class="dt">newdata =</span> ., <span class="dt">nsamples =</span> <span class="dv">1000</span>)

<span class="kw">ggplot</span>(lpred) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> <span class="kw">plogis</span>(.posterior_value), <span class="dt">color =</span> Study) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> .<span class="dv">25</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> <span class="kw">interaction</span>(Study, .draw)), 
            <span class="dt">alpha =</span> .<span class="dv">1</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;Study&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="st">&quot;none&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">title =</span> <span class="st">&quot;Posterior predictions for 1,000 new participants&quot;</span>,
    <span class="dt">x =</span> <span class="st">&quot;Time after target onset&quot;</span>,
    <span class="dt">y =</span> <span class="st">&quot;Proportion looks to target&quot;</span>)</code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/new-participants-1.png" width="80%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(lpred) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> <span class="kw">plogis</span>(.posterior_value), <span class="dt">color =</span> Study) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> .<span class="dv">25</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> median_hilow, <span class="dt">fun.args =</span> <span class="kw">list</span>(<span class="dt">conf.int =</span> .<span class="dv">9</span>),
               <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">geom =</span> <span class="st">&quot;linerange&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> median_hilow, <span class="dt">fun.args =</span> <span class="kw">list</span>(<span class="dt">conf.int =</span> .<span class="dv">5</span>), 
               <span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">geom =</span> <span class="st">&quot;linerange&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> median, <span class="dt">fun.args =</span> <span class="kw">list</span>(<span class="dt">conf.int =</span> .<span class="dv">5</span>), 
               <span class="dt">size =</span> <span class="fl">2.5</span>, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;Study&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="st">&quot;none&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">title =</span> <span class="st">&quot;Posterior predictions for 1,000 new participants&quot;</span>,
    <span class="dt">x =</span> <span class="st">&quot;Time after target onset&quot;</span>,
    <span class="dt">y =</span> <span class="st">&quot;Proportion looks to target&quot;</span>)</code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/new-participants-2.png" width="80%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">by_draw &lt;-<span class="st"> </span>lpred <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(Study, Time) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">iqr =</span> <span class="kw">IQR</span>(<span class="kw">plogis</span>(.posterior_value)),
    <span class="dt">min =</span> <span class="kw">min</span>(<span class="kw">plogis</span>(.posterior_value)),
    <span class="dt">max =</span> <span class="kw">max</span>(<span class="kw">plogis</span>(.posterior_value)),
    <span class="dt">range =</span> max <span class="op">-</span><span class="st"> </span>min)

<span class="kw">ggplot</span>(by_draw) <span class="op">+</span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> range, <span class="dt">color =</span> Study) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> median_hilow, <span class="dt">fun.args =</span> <span class="kw">list</span>(<span class="dt">conf.int =</span> .<span class="dv">9</span>),
               <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">geom =</span> <span class="st">&quot;linerange&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> median_hilow, <span class="dt">fun.args =</span> <span class="kw">list</span>(<span class="dt">conf.int =</span> .<span class="dv">5</span>),
               <span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">geom =</span> <span class="st">&quot;linerange&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> median, <span class="dt">fun.args =</span> <span class="kw">list</span>(<span class="dt">conf.int =</span> .<span class="dv">5</span>),
               <span class="dt">size =</span> <span class="fl">2.5</span>, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">title =</span> <span class="st">&quot;Ranges of predictions for 1000 new participants&quot;</span>,
    <span class="dt">x =</span> <span class="st">&quot;Time after target onset&quot;</span>,
    <span class="dt">y =</span> <span class="st">&quot;Max - min predicted value&quot;</span>) </code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/hmmm-new-participants-1.png" width="80%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(by_draw) <span class="op">+</span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> iqr, <span class="dt">color =</span> Study) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> median_hilow, <span class="dt">fun.args =</span> <span class="kw">list</span>(<span class="dt">conf.int =</span> .<span class="dv">9</span>),
               <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">geom =</span> <span class="st">&quot;linerange&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> median_hilow, <span class="dt">fun.args =</span> <span class="kw">list</span>(<span class="dt">conf.int =</span> .<span class="dv">5</span>),
               <span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">geom =</span> <span class="st">&quot;linerange&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> median, <span class="dt">fun.args =</span> <span class="kw">list</span>(<span class="dt">conf.int =</span> .<span class="dv">5</span>),
               <span class="dt">size =</span> <span class="fl">2.5</span>, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">title =</span> <span class="st">&quot;25%-75% ranges of predictions&quot;</span>,
    <span class="dt">x =</span> <span class="st">&quot;Time after target onset&quot;</span>,
    <span class="dt">y =</span> <span class="st">&quot;Interquartile range of predictions&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, .<span class="dv">25</span>)</code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/hmmm-new-participants-2.png" width="80%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

<span class="co"># in_every_study &lt;- d_m %&gt;% </span>
<span class="co">#   distinct(Study, ResearchID) %&gt;% </span>
<span class="co">#   split(.$Study) %&gt;% </span>
<span class="co">#   lapply(getElement, &quot;ResearchID&quot;) %&gt;% </span>
<span class="co">#   Reduce(intersect, .)</span>
<span class="co"># </span>
<span class="co"># d_m_every &lt;- d_m %&gt;% </span>
<span class="co">#   filter(ResearchID %in% in_every_study)</span>
<span class="co"># </span>
<span class="co"># sims &lt;- tristan::augment_posterior_linpred(b, d_m_every, nsamples = 1000)</span>
<span class="co"># </span>
<span class="co"># ggplot(sims) + </span>
<span class="co">#   aes(x = Time, y = plogis(.posterior_value, color = Study) +</span>
<span class="co">#   geom_hline(yintercept = .25, size = 2, color = &quot;white&quot;) +</span>
<span class="co">#   stat_summary(fun.data = median_hilow, fun.args = list(conf.int = .9),</span>
<span class="co">#                size = 1, geom = &quot;linerange&quot;) + </span>
<span class="co">#   stat_summary(fun.data = median_hilow, fun.args = list(conf.int = .5), </span>
<span class="co">#                size = 1.5, geom = &quot;linerange&quot;) + </span>
<span class="co">#   stat_summary(fun.y = median, fun.args = list(conf.int = .5), </span>
<span class="co">#                size = 2.5, geom = &quot;point&quot;) + </span>
<span class="co">#   # geom_line(aes(group = interaction(Study, ResearchID, .draw)), </span>
<span class="co">#   #           alpha = .1) +</span>
<span class="co">#   # facet_wrap(&quot;ResearchID&quot;) + </span>
<span class="co">#   geom_point(aes(y = qlogis(Prop)), shape = 1) + </span>
<span class="co">#   theme(</span>
<span class="co">#     legend.position = c(.95, 0), </span>
<span class="co">#     legend.justification = c(1, 0),</span>
<span class="co">#     legend.margin = margin(0)) +</span>
<span class="co">#   guides(color = guide_legend(title = NULL, override.aes = list(alpha = 1))) +</span>
<span class="co">#   labs(</span>
<span class="co">#     title = &quot;Observed data and 100 posterior predictions&quot;,</span>
<span class="co">#     x = &quot;Time after target onset&quot;,</span>
<span class="co">#     y = &quot;Posterior log-odds&quot;)</span>
<span class="co"># sds &lt;- fits %&gt;% </span>
<span class="co">#   group_by(Study, coef, .draw) %&gt;% </span>
<span class="co">#   summarise(</span>
<span class="co">#     mean = mean(.posterior_value),</span>
<span class="co">#     min = min(.posterior_value),</span>
<span class="co">#     max = max(.posterior_value),</span>
<span class="co">#     range = max - min,</span>
<span class="co">#     sd = sd(.posterior_value)) %&gt;%</span>
<span class="co">#   group_by(Study, coef) %&gt;% </span>
<span class="co">#   select(-.draw) %&gt;% </span>
<span class="co">#   do(bayesplot::mcmc_intervals_data(select(., mean:sd))) %&gt;% </span>
<span class="co">#   ungroup()</span>
<span class="co"># </span>
<span class="co"># ggplot(sds %&gt;% filter(coef %in% c(&quot;intercept&quot;, &quot;ot1&quot;))) + </span>
<span class="co">#   aes(y = forcats::fct_rev(Study)) +</span>
<span class="co">#   geom_vline(xintercept = 0, size = 2, color = &quot;white&quot;) +</span>
<span class="co">#   ggstance::geom_linerangeh(aes(xmin = ll, xmax = hh)) + </span>
<span class="co">#   ggstance::geom_linerangeh(aes(xmin = l, xmax = h), size = 2) +</span>
<span class="co">#   geom_point(aes(x = m), size = 3, shape = 3) + </span>
<span class="co">#   labs(x = NULL, y = NULL, caption = &quot;90% and 50% intervals&quot;) + </span>
<span class="co">#   facet_grid(parameter ~ coef, scales = &quot;free&quot;)</span>
<span class="co">#   facet_gird(&quot;coef&quot;, ncol = 1, strip.position = &quot;left&quot;, </span>
<span class="co">#              labeller = label_parsed, scales = &quot;free&quot;) + </span>
<span class="co">#   theme(strip.placement = &quot;outside&quot;, </span>
<span class="co">#         strip.background = element_rect(fill = NA),</span>
<span class="co">#         axis.text.y = element_text(size = rel(1.2))) </span></code></pre></div>
</div>
<div id="predicting-the-future" class="section level3">
<h3><span class="header-section-number">10.3.6</span> Predicting the future</h3>
<blockquote>
<p>As a consequence, individual differences in word recognition at age 3, for example, will be more discriminating and predictive of age 5 language outcomes than differences at age 4.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fits &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(<span class="st">&quot;./data/fits.csv.gz&quot;</span>)
<span class="co">#&gt; Parsed with column specification:</span>
<span class="co">#&gt; cols(</span>
<span class="co">#&gt;   .draw = col_integer(),</span>
<span class="co">#&gt;   Study = col_character(),</span>
<span class="co">#&gt;   ResearchID = col_character(),</span>
<span class="co">#&gt;   coef = col_character(),</span>
<span class="co">#&gt;   .posterior_value = col_double()</span>
<span class="co">#&gt; )</span>
fits &lt;-<span class="st"> </span>fits <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">semi_join</span>(d_m)
<span class="co">#&gt; Joining, by = c(&quot;Study&quot;, &quot;ResearchID&quot;)</span>

point_ests &lt;-<span class="st"> </span>fits <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Study, ResearchID, coef) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">point =</span> <span class="kw">median</span>(.posterior_value)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">spread</span>(coef, point)

scores &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(<span class="st">&quot;./data-raw/test_scores.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Study, ResearchID, Age, EVT_GSV, EVT_Standard, 
         PPVT_GSV, PPVT_Standard)
<span class="co">#&gt; Parsed with column specification:</span>
<span class="co">#&gt; cols(</span>
<span class="co">#&gt;   .default = col_integer(),</span>
<span class="co">#&gt;   Study = col_character(),</span>
<span class="co">#&gt;   ResearchID = col_character(),</span>
<span class="co">#&gt;   Female = col_logical(),</span>
<span class="co">#&gt;   Male = col_logical(),</span>
<span class="co">#&gt;   MAE = col_logical(),</span>
<span class="co">#&gt;   AAE = col_logical(),</span>
<span class="co">#&gt;   Maternal_Education_LMH = col_character(),</span>
<span class="co">#&gt;   MinPair_ProportionCorrect = col_double(),</span>
<span class="co">#&gt;   SAILS_ProportionTestCorrect = col_double()</span>
<span class="co">#&gt; )</span>
<span class="co">#&gt; See spec(...) for full column specifications.</span>

with_ests &lt;-<span class="st"> </span>scores <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">inner_join</span>(point_ests)
<span class="co">#&gt; Joining, by = c(&quot;Study&quot;, &quot;ResearchID&quot;)</span>

<span class="kw">ggplot</span>(with_ests) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> intercept, <span class="dt">y =</span> EVT_GSV, <span class="dt">color =</span> Study) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)
<span class="co">#&gt; Warning: Removed 2 rows containing non-finite values (stat_smooth).</span>
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/bunch-of-plots-1.png" width="80%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(with_ests) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> ot1, <span class="dt">y =</span> EVT_GSV, <span class="dt">color =</span> Study) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)
<span class="co">#&gt; Warning: Removed 2 rows containing non-finite values (stat_smooth).</span>

<span class="co">#&gt; Warning: Removed 2 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/bunch-of-plots-2.png" width="80%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(with_ests) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Age, <span class="dt">y =</span> intercept, <span class="dt">color =</span> Study) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/bunch-of-plots-3.png" width="80%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(with_ests) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> Age, <span class="dt">y =</span> ot1, <span class="dt">color =</span> Study) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/bunch-of-plots-4.png" width="80%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
widely &lt;-<span class="st"> </span>with_ests <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="st">&quot;Test&quot;</span>, <span class="st">&quot;Value&quot;</span>, <span class="op">-</span>ResearchID, <span class="op">-</span>Study) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">unite</span>(<span class="st">&quot;Col&quot;</span>, Study, Test) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">spread</span>(Col, Value)


<span class="kw">ggplot</span>(widely) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> TimePoint1_intercept, <span class="dt">y =</span> TimePoint3_EVT_GSV) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)
<span class="co">#&gt; Warning: Removed 67 rows containing non-finite values (stat_smooth).</span>
<span class="co">#&gt; Warning: Removed 67 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/bunch-of-plots-5.png" width="80%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(widely) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> TimePoint2_intercept, <span class="dt">y =</span> TimePoint3_EVT_GSV) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)
<span class="co">#&gt; Warning: Removed 45 rows containing non-finite values (stat_smooth).</span>
<span class="co">#&gt; Warning: Removed 45 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/bunch-of-plots-6.png" width="80%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(widely) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> TimePoint1_ot1, <span class="dt">y =</span> TimePoint3_EVT_GSV) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)
<span class="co">#&gt; Warning: Removed 67 rows containing non-finite values (stat_smooth).</span>
<span class="co">#&gt; Warning: Removed 67 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/bunch-of-plots-7.png" width="80%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(widely) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> TimePoint2_ot1, <span class="dt">y =</span> TimePoint3_EVT_GSV) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)
<span class="co">#&gt; Warning: Removed 45 rows containing non-finite values (stat_smooth).</span>
<span class="co">#&gt; Warning: Removed 45 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/bunch-of-plots-8.png" width="80%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(widely) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> TimePoint3_ot1, <span class="dt">y =</span> TimePoint3_EVT_GSV) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)
<span class="co">#&gt; Warning: Removed 35 rows containing non-finite values (stat_smooth).</span>
<span class="co">#&gt; Warning: Removed 35 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/bunch-of-plots-9.png" width="80%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cor_complete &lt;-<span class="st"> </span><span class="cf">function</span>(...) <span class="kw">cor</span>(..., <span class="dt">use =</span> <span class="st">&quot;pairwise.complete&quot;</span>)

test &lt;-<span class="st"> </span>fits <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">left_join</span>(widely) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Study, coef, .draw) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">r_TimePoint3_EVT_Standard =</span> <span class="kw">cor_complete</span>(.posterior_value, 
                                             TimePoint3_EVT_Standard),
    <span class="dt">r_TimePoint3_EVT_GSV =</span> <span class="kw">cor_complete</span>(.posterior_value, 
                                        TimePoint3_EVT_GSV),
    <span class="dt">r_TimePoint2_PPVT_GSV =</span> <span class="kw">cor_complete</span>(.posterior_value, 
                                         TimePoint2_PPVT_GSV),
    <span class="dt">r_TimePoint2_PPVT_Standard =</span> <span class="kw">cor_complete</span>(.posterior_value, 
                                              TimePoint2_PPVT_Standard))
<span class="co">#&gt; Joining, by = &quot;ResearchID&quot;</span>

c_intervals &lt;-<span class="st"> </span>test <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">do</span>(bayesplot<span class="op">::</span><span class="kw">mcmc_intervals_data</span>(
    <span class="kw">select</span>(., r_TimePoint3_EVT_Standard<span class="op">:</span>r_TimePoint2_PPVT_Standard))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ungroup</span>()

c_intervals <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(parameter <span class="op">==</span><span class="st"> &quot;r_TimePoint3_EVT_Standard&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(coef <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;ot1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">aes</span>(<span class="dt">y =</span> forcats<span class="op">::</span><span class="kw">fct_rev</span>(Study)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span>
<span class="st">    </span>ggstance<span class="op">::</span><span class="kw">geom_linerangeh</span>(<span class="kw">aes</span>(<span class="dt">xmin =</span> ll, <span class="dt">xmax =</span> hh)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span>ggstance<span class="op">::</span><span class="kw">geom_linerangeh</span>(<span class="kw">aes</span>(<span class="dt">xmin =</span> l, <span class="dt">xmax =</span> h), <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> m), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">shape =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="st">&quot;coef&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">caption =</span> <span class="st">&quot;90% and 50% intervals&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Correlation of curve features and TP3 EVT Standard&quot;</span>)</code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/bunch-of-plots2-1.png" width="80%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
c_intervals <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(parameter <span class="op">==</span><span class="st"> &quot;r_TimePoint2_PPVT_Standard&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(coef <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;ot1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(Study <span class="op">!=</span><span class="st"> &quot;TimePoint3&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">aes</span>(<span class="dt">y =</span> forcats<span class="op">::</span><span class="kw">fct_rev</span>(Study)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span>
<span class="st">    </span>ggstance<span class="op">::</span><span class="kw">geom_linerangeh</span>(<span class="kw">aes</span>(<span class="dt">xmin =</span> ll, <span class="dt">xmax =</span> hh)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span>ggstance<span class="op">::</span><span class="kw">geom_linerangeh</span>(<span class="kw">aes</span>(<span class="dt">xmin =</span> l, <span class="dt">xmax =</span> h), <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> m), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">shape =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="st">&quot;coef&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">caption =</span> <span class="st">&quot;90% and 50% intervals&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Correlation of curve features and TP2 PPVT Standard&quot;</span>)</code></pre></div>
<p><img src="12-aim1-notebook_files/figure-html/bunch-of-plots2-2.png" width="80%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># test %&gt;% </span>
<span class="co">#   filter(coef == &quot;intercept&quot;) %&gt;%</span>
<span class="co">#   ggplot() + </span>
<span class="co">#   aes(x = c1) + </span>
<span class="co">#   geom_histogram() + </span>
<span class="co">#   facet_grid(Study ~ coef)</span>
<span class="co"># </span>
<span class="co"># test %&gt;% </span>
<span class="co">#   filter(coef == &quot;ot1&quot;) %&gt;%</span>
<span class="co">#   ggplot() + </span>
<span class="co">#   aes(x = c1) + </span>
<span class="co">#   geom_histogram() + </span>
<span class="co">#   facet_grid(Study ~ coef)</span>
<span class="co"># </span>
<span class="co"># test %&gt;% </span>
<span class="co">#   filter(coef == &quot;ot2&quot;) %&gt;%</span>
<span class="co">#   ggplot() + </span>
<span class="co">#   aes(x = c1) + </span>
<span class="co">#   geom_histogram() + </span>
<span class="co">#   facet_grid(Study ~ coef)</span>

widely <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tidy_correlation</span>(<span class="kw">ends_with</span>(<span class="st">&quot;EVT_GSV&quot;</span>))
<span class="co">#&gt; # A tibble: 3 x 5</span>
<span class="co">#&gt;              column1            column2 estimate     n p.value</span>
<span class="co">#&gt;                &lt;chr&gt;              &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 TimePoint1_EVT_GSV TimePoint2_EVT_GSV   0.7087   128       0</span>
<span class="co">#&gt; 2 TimePoint1_EVT_GSV TimePoint3_EVT_GSV   0.6875   121       0</span>
<span class="co">#&gt; 3 TimePoint2_EVT_GSV TimePoint3_EVT_GSV   0.8511   143       0</span>

widely <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy_correlation</span>(TimePoint3_EVT_GSV, <span class="kw">ends_with</span>(<span class="st">&quot;intercept&quot;</span>), <span class="kw">ends_with</span>(<span class="st">&quot;ot1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(column1 <span class="op">==</span><span class="st"> &quot;TimePoint3_EVT_GSV&quot;</span>)
<span class="co">#&gt; # A tibble: 6 x 5</span>
<span class="co">#&gt;              column1              column2 estimate     n p.value</span>
<span class="co">#&gt;                &lt;chr&gt;                &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 TimePoint3_EVT_GSV TimePoint1_intercept   0.5058   121   0e+00</span>
<span class="co">#&gt; 2 TimePoint3_EVT_GSV TimePoint2_intercept   0.4398   143   0e+00</span>
<span class="co">#&gt; 3 TimePoint3_EVT_GSV TimePoint3_intercept   0.3648   153   0e+00</span>
<span class="co">#&gt; 4 TimePoint3_EVT_GSV       TimePoint1_ot1   0.4518   121   0e+00</span>
<span class="co">#&gt; 5 TimePoint3_EVT_GSV       TimePoint2_ot1   0.3253   143   1e-04</span>
<span class="co">#&gt; 6 TimePoint3_EVT_GSV       TimePoint3_ot1   0.3144   153   1e-04</span>

widely <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy_correlation</span>(TimePoint2_PPVT_GSV, TimePoint1_ot1, TimePoint2_ot1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(column1 <span class="op">==</span><span class="st"> &quot;TimePoint2_PPVT_GSV&quot;</span>)
<span class="co">#&gt; # A tibble: 2 x 5</span>
<span class="co">#&gt;               column1        column2 estimate     n p.value</span>
<span class="co">#&gt;                 &lt;chr&gt;          &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 TimePoint2_PPVT_GSV TimePoint1_ot1   0.4807   127       0</span>
<span class="co">#&gt; 2 TimePoint2_PPVT_GSV TimePoint2_ot1   0.3418   161       0</span>

widely <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy_correlation</span>(TimePoint2_PPVT_GSV, TimePoint1_ot1, TimePoint2_ot1,
            TimePoint1_intercept, TimePoint2_intercept) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(column1 <span class="op">==</span><span class="st"> &quot;TimePoint2_PPVT_GSV&quot;</span>)
<span class="co">#&gt; # A tibble: 4 x 5</span>
<span class="co">#&gt;               column1              column2 estimate     n p.value</span>
<span class="co">#&gt;                 &lt;chr&gt;                &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 TimePoint2_PPVT_GSV       TimePoint1_ot1   0.4807   127       0</span>
<span class="co">#&gt; 2 TimePoint2_PPVT_GSV       TimePoint2_ot1   0.3418   161       0</span>
<span class="co">#&gt; 3 TimePoint2_PPVT_GSV TimePoint1_intercept   0.4997   127       0</span>
<span class="co">#&gt; 4 TimePoint2_PPVT_GSV TimePoint2_intercept   0.4248   161       0</span></code></pre></div>
</div>
<div id="relationship-with-child-level-variables" class="section level3">
<h3><span class="header-section-number">10.3.7</span> Relationship with child-level variables</h3>
<blockquote>
<p>Vocabulary size and lexical processing will be tightly correlated such that large year-over-year gains in one measure will predict large year-over-years gains in the other measure.</p>
</blockquote>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="prepare-and-explore-the-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="visualize-looks-to-each-image-type.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["dissertation.pdf", "dissertation.epub", "dissertation.docx"],
"toc": {
"collapse": "subsection"
},
"split_bib": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
